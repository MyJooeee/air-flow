(this["webpackJsonpair-flow"]=this["webpackJsonpair-flow"]||[]).push([[0],{165:function(t,e,a){"use strict";a.r(e);var n=a(0),o=a.n(n),i=a(22),r=a.n(i),c=(a(63),a(64),a(56)),s=a(6),l=a(50),u=a(51),d=a(57),h=a(55),m=a(53),g=a(7),p=(a(163),a(167)),b=a(168),f=a(169),j=a(171),O=a(170),x=a(54),v=a(3),w=a(1);function y(t){var e=t.coordinates,a=t.altitude;function n(t){var e=t.center,a=t.zoom;return Object(p.a)().setView(e,a),null}var o=null;return a&&(o=Object(w.jsx)(b.a,{children:"alt. ".concat(a.toFixed(2),"m")})),Object(w.jsxs)(f.a,{id:"mapId",center:e,zoom:14,scrollWheelZoom:!1,style:{height:180,width:180,margin:"20px"},children:[Object(w.jsx)(n,{center:e,zoom:14}),Object(w.jsx)(j.a,{attribution:"\xa9AirFlow",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),Object(w.jsx)(O.a,{position:e,icon:new v.Icon({iconUrl:x.a,iconSize:[25,41],iconAnchor:[12,41]}),children:o})]})}var L=a(24),A=a.n(L),C=function(t){Object(d.a)(a,t);var e=Object(h.a)(a);function a(t){var n;Object(l.a)(this,a),(n=e.call(this,t)).getData=function(){n.getAirFlowData(),n.getNameLocation(),n.getWeatherLocation()},n.getDataLine=function(){return{labels:n.state.label,datasets:[{label:"\u0421oncentration of CO (Carbon monoxide), \u03bcg/m3",data:n.state.data.co,fill:!1,backgroundColor:"rgb(255, 99, 132)",borderColor:"rgba(255, 99, 132, 0.3)"},{label:"\u0421oncentration of O3 (Ozone), \u03bcg/m3",data:n.state.data.o3,fill:!1,backgroundColor:"rgb(0, 140, 255)",borderColor:"rgba(0, 140, 255, 0.3)"},{label:"\u0421oncentration of SO2 (Sulphur dioxide), \u03bcg/m3",data:n.state.data.so2,fill:!1,backgroundColor:"rgb(199, 140, 255)",borderColor:"rgba(199, 140, 255, 0.3)"},{label:"\u0421oncentration of PM2.5 (Fine particles matter), \u03bcg/m3",data:n.state.data.pm2_5,fill:!1,backgroundColor:"rgb(67, 245, 123)",borderColor:"rgba(67, 245, 123, 0.3)"}]}},n.getOptionsLine=function(){return{scales:{yAxes:[{ticks:{beginAtZero:!0}}]},maintainAspectRatio:!1}},n.getAirFlowData=function(){var t=n.airQualityAPI+"&lat="+n.state.latitude+"&lon="+n.state.longitude;fetch(t).then((function(t){return t.json()})).then((function(t){var e=Object(s.a)({},n.state.data),a=e.co,o=t.list[0].components.co;a.push(o);var i=e.o3;o=t.list[0].components.o3,i.push(o);var r=e.so2;o=t.list[0].components.so2,r.push(o);var l=e.pm2_5;o=t.list[0].components.pm2_5,l.push(o),e={co:a,o3:i,so2:r,pm2_5:l};var u=Object(c.a)(n.state.label),d=(new Date).toLocaleTimeString();u.push(d);var h=t.list[0].main.aqi;n.setState({data:e,label:u,indexQuality:h})}),(function(t){console.log(t)}))},n.getNameLocation=function(){var t=n.reverseLocationAPI+"&lat="+n.state.latitude+"&lon="+n.state.longitude;fetch(t).then((function(t){return t.json()})).then((function(t){n.setState({nameLocation:t[0].name})}),(function(t){console.log(t)}))},n.getWeatherLocation=function(){var t=n.weatherFromLocationAPI+"&lat="+n.state.latitude+"&lon="+n.state.longitude;fetch(t).then((function(t){return t.json()})).then((function(t){var e={main:t.weather[0].main,description:t.weather[0].description,icon:t.weather[0].icon,temperature:t.main.temp,humidity:t.main.humidity};n.setState({weatherLocation:e})}),(function(t){console.log(t)}))},n.renderTitle=function(){return n.state.nameLocation?"Air quality in "+n.state.nameLocation:"Loading..."},n.renderAirQuality=function(){return"Quality : "+n.airQuality[n.state.indexQuality]+(0!==n.state.indexQuality?" ("+(6-n.state.indexQuality)/5*100+"%)":"")},n.renderWeather=function(){if(!n.state.weatherLocation)return null;var t="https://openweathermap.org/img/wn/"+n.state.weatherLocation.icon+".png",e=n.state.weatherLocation.main,a=n.state.weatherLocation.description,o=n.state.weatherLocation.icon,i=n.state.weatherLocation.temperature,r=n.state.weatherLocation.humidity;return Object(w.jsxs)("div",{className:Object(g.a)({display:"flex",flexFlow:"row wrap",alignItems:"center"}),children:[Object(w.jsx)("img",{src:t,title:e,alt:o}),Object(w.jsxs)("span",{className:Object(g.a)({fontSize:"1.2rem"}),children:[" ",i,"\xb0C. | ",r,"%"]}),Object(w.jsxs)("span",{className:Object(g.a)({fontSize:"1rem",marginLeft:"5px"}),children:[" ",a," "]})]})};var o="43cebb6f101584f15a47a1581d009ee7";return n.airQualityAPI="https://api.openweathermap.org/data/2.5/air_pollution?appid="+o,n.reverseLocationAPI="https://api.openweathermap.org/geo/1.0/reverse?limit=1&appid="+o,n.weatherFromLocationAPI="https://api.openweathermap.org/data/2.5/weather?&units=metric&appid="+o,n.airQuality=["loading...","good quality","fair quality","moderate quality","poor quality","very poor quality"],n.state={refreshAt:A()().format("hh:mm:ss"),data:{co:[],o3:[],so2:[],pm2_5:[]},label:[],indexQuality:0,latitude:48.856614,longitude:2.3522219,altitude:35,nameLocation:null,weatherLocation:null},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var t=this;if(navigator.geolocation){navigator.geolocation.getCurrentPosition((function(e){t.setState({latitude:e.coords.latitude,longitude:e.coords.longitude,altitude:e.coords.altitude},(function(){t.getData()}))}),(function(e){t.getData(),console.log(e)}),{enableHighAccuracy:!0,timeout:5e3,maximumAge:0})}this.line=setInterval((function(){t.setState({refreshAt:A()().format("hh:mm:ss")}),t.getAirFlowData(),t.getWeatherLocation()}),3e5)}},{key:"componentWillUnmount",value:function(){clearInterval(this.line)}},{key:"render",value:function(){return Object(w.jsxs)("div",{className:Object(g.a)({height:"60vh"}),children:[Object(w.jsxs)("div",{className:Object(g.a)({display:"flex",flexFlow:"row wrap",alignItems:"center",justifyContent:"space-around"}),children:[Object(w.jsxs)("h1",{className:Object(g.a)({textAlign:"center"}),children:[" ",this.renderTitle()," "]}),Object(w.jsxs)("h2",{children:[" ",this.renderAirQuality()," "]}),Object(w.jsxs)("h2",{children:[" ",this.renderWeather()," "]}),Object(w.jsx)(y,{coordinates:[this.state.latitude,this.state.longitude],altitude:this.state.altitude})]}),Object(w.jsx)(m.Line,{height:550,width:1100,data:this.getDataLine(),options:this.getOptionsLine()}),Object(w.jsx)("div",{className:Object(g.a)({display:"flex",justifyContent:"center"}),children:Object(w.jsxs)("small",{children:["Auto refresh data air quality ",Object(w.jsx)("strong",{children:" every 5 minutes"})," ",Object(w.jsxs)("i",{children:[" (",this.state.refreshAt,"). "]})]})})]})}}]),a}(o.a.Component);var F=function(){return Object(w.jsx)(C,{})},I=function(t){t&&t instanceof Function&&a.e(3).then(a.bind(null,172)).then((function(e){var a=e.getCLS,n=e.getFID,o=e.getFCP,i=e.getLCP,r=e.getTTFB;a(t),n(t),o(t),i(t),r(t)}))};r.a.render(Object(w.jsx)(o.a.StrictMode,{children:Object(w.jsx)(F,{})}),document.getElementById("root")),I()},63:function(t,e,a){},64:function(t,e,a){}},[[165,1,2]]]);
//# sourceMappingURL=main.93a24c88.chunk.js.map